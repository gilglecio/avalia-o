(function(e){var t=function(t,n,r){var i=this;t=e(t);var s;n="function"==typeof n?n(t.val(),r):n,i.init=function(){r=r||{},i.byPassKeys=[8,9,16,37,38,39,40,46,91],i.translation={0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}},i.translation=e.extend({},i.translation,r.translation),i=e.extend(!0,{},i,r),t.each(function(){!1!==r.maxlength&&t.attr("maxlength",n.length),t.attr("autocomplete","off"),o.destroyEvents(),o.events(),o.val(o.getMasked())})};var o={events:function(){t.on("keydown.mask",function(){s=o.val()}),t.on("keyup.mask",o.behaviour),t.on("paste.mask",function(){setTimeout(function(){t.keydown().keyup()},100)})},destroyEvents:function(){t.off("keydown.mask").off("keyup.mask").off("paste.mask")},val:function(e){var n="input"===t.get(0).tagName.toLowerCase();return 0<arguments.length?n?t.val(e):t.text(e):n?t.val():t.text()},behaviour:function(t){t=t||window.event;if(-1===e.inArray(t.keyCode||t.which,i.byPassKeys))return o.val(o.getMasked()),o.callbacks(t)},getMasked:function(){var e=[],t=o.val(),s=0,u=n.length,a=0,l=t.length,c=1,h="push",p=-1,v,m;r.reverse?(h="unshift",c=-1,v=0,s=u-1,a=l-1,m=function(){return-1<s&&-1<a}):(v=u-1,m=function(){return s<u&&a<l});for(;m();){var y=n.charAt(s),b=t.charAt(a),w=i.translation[y];w?(b.match(w.pattern)?(e[h](b),w.recursive&&(-1==p?p=s:s==v&&(s=p-c),v==p&&(s-=c)),s+=c):w.optional&&(s+=c,a-=c),a+=c):(e[h](y),b==y&&(a+=c),s+=c)}return e.join("")},callbacks:function(e){var i=o.val(),u=o.val()!==s;!0===u&&"function"==typeof r.onChange&&r.onChange(i,e,t,r),!0===u&&"function"==typeof r.onKeyPress&&r.onKeyPress(i,e,t,r),"function"==typeof r.onComplete&&i.length===n.length&&r.onComplete(i,e,t,r)}};i.remove=function(){o.destroyEvents(),o.val(i.getCleanVal()).removeAttr("maxlength")},i.getCleanVal=function(){for(var e=[],t=o.val(),r=0,s=n.length;r<s;r++)i.translation[n.charAt(r)]&&e.push(t.charAt(r));return e.join("")},i.init()};e.fn.mask=function(n,r){return this.each(function(){e(this).data("mask",new t(this,n,r))})},e.fn.unmask=function(){return this.each(function(){e(this).data("mask").remove()})},e("input[data-mask]").each(function(){var t=e(this),n={};"true"===t.attr("data-mask-reverse")&&(n.reverse=!0),"false"===t.attr("data-mask-maxlength")&&(n.maxlength=!1),t.mask(t.attr("data-mask"),n)})})(window.jQuery||window.Zepto);